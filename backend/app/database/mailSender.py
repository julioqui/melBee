from __future__ import print_function
# from asyncio.windows_events import NULL
from cgitb import html
from email import message
import email
import os
from google.auth.transport.requests import Request
from google.oauth2.credentials import Credentials
from google_auth_oauthlib.flow import InstalledAppFlow
from googleapiclient.discovery import build
from googleapiclient.errors import HttpError
from email.mime.image import MIMEImage
from email.mime.multipart import MIMEMultipart
from email.mime.audio import MIMEAudio
from email.mime.base import MIMEBase
from email.mime.text import MIMEText
import mimetypes
import base64

# If modifying these scopes, delete the file token.json.
SCOPES = ['https://mail.google.com/']


def getService():
    """Shows basic usage of the Gmail API.
    Lists the user's Gmail labels.
    """
    creds = None
    # The file token.json stores the user's access and refresh tokens, and is
    # created automatically when the authorization flow completes for the first
    # time.
    if os.path.exists('token.json'):
        creds = Credentials.from_authorized_user_file('token.json', SCOPES)
    # If there are no (valid) credentials available, let the user log in.
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file(
                './credentials.json', SCOPES)
            creds = flow.run_local_server(port=8080)
        # Save the credentials for the next run
        with open('token.json', 'w') as token:
            token.write(creds.to_json())

    service = build('gmail', 'v1', credentials=creds)

    return service


def create_message(sender, to, subject, message_text):
    message = MIMEText(message_text, "html")
    message['to'] = to
    message['from'] = sender
    message['subject'] = subject
    raw_message = base64.urlsafe_b64encode(message.as_string().encode("utf-8"))
    return {
        'raw': raw_message.decode("utf-8")
    }


def create_draft(service, user_id, message_body):
    try:
        message = {'message': message_body}
        draft = service.users().drafts().create(userId=user_id, body=message).execute()
        print("Draft id: %s\nDraft message: %s" %
              (draft['id'], draft['message']))
        return draft
    except Exception as e:
        print('An error occurred: %s' % e)
        return None


def send_message(service, user_id, message):
    try:
        message = service.users().messages().send(
            userId=user_id, body=message).execute()
        print('Message Id: %s' % message['id'])
        return message
    except Exception as e:
        print('An error occurred: %s' % e)
        return None

html = '<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office"><head><!--[if gte mso 9]><xml>  <o:OfficeDocumentSettings>    <o:AllowPNG/>    <o:PixelsPerInch>96</o:PixelsPerInch>  </o:OfficeDocumentSettings></xml><![endif]-->  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">  <meta name="viewport" content="width=device-width, initial-scale=1.0">  <meta name="x-apple-disable-message-reformatting">  <!--[if !mso]><!--><meta http-equiv="X-UA-Compatible" content="IE=edge"><!--<![endif]-->  <title></title>      <style type="text/css">      @media only screen and (min-width: 620px) {  .u-row {    width: 600px !important;  }  .u-row .u-col {    vertical-align: top;  }  .u-row .u-col-13p5 {    width: 81px !important;  }  .u-row .u-col-32 {    width: 192px !important;  }  .u-row .u-col-33p33 {    width: 199.98px !important;  }  .u-row .u-col-53p17 {    width: 319.02px !important;  }  .u-row .u-col-66p67 {    width: 400.02px !important;  }  .u-row .u-col-68 {    width: 408px !important;  }  .u-row .u-col-100 {    width: 600px !important;  }}@media (max-width: 620px) {  .u-row-container {    max-width: 100% !important;    padding-left: 0px !important;    padding-right: 0px !important;  }  .u-row .u-col {    min-width: 320px !important;    max-width: 100% !important;    display: block !important;  }  .u-row {    width: calc(100% - 40px) !important;  }  .u-col {    width: 100% !important;  }  .u-col > div {    margin: 0 auto;  }}body {  margin: 0;  padding: 0;}table,tr,td {  vertical-align: top;  border-collapse: collapse;}p {  margin: 0;}.ie-container table,.mso-container table {  table-layout: fixed;}* {  line-height: inherit;}a[x-apple-data-detectors="true"] {  color: inherit !important;  text-decoration: none !important;}@media (max-width: 480px) {  .hide-mobile {    max-height: 0px;    overflow: hidden;    display: none !important;  }}table, td { color: #000000; } #u_body a { color: #0000ee; text-decoration: underline; } @media (max-width: 480px) { #u_content_heading_2 .v-font-size { font-size: 32px !important; } #u_column_2 .v-col-padding { padding: 60px 0px 0px !important; } #u_content_heading_1 .v-container-padding-padding { padding: 10px 20px !important; } #u_content_heading_1 .v-font-size { font-size: 32px !important; } #u_content_heading_1 .v-text-align { text-align: center !important; } #u_content_text_7 .v-container-padding-padding { padding: 10px 20px !important; } #u_content_text_7 .v-text-align { text-align: center !important; } #u_column_3 .v-col-padding { padding: 30px 0px 60px !important; } #u_column_5 .v-col-padding { padding: 60px 0px 0px !important; } #u_content_text_3 .v-text-align { text-align: center !important; } #u_content_text_6 .v-text-align { text-align: center !important; } #u_content_text_5 .v-container-padding-padding { padding: 10px 20px !important; } #u_content_text_5 .v-text-align { text-align: center !important; } #u_column_6 .v-col-padding { padding: 35px 0px 0px !important; } #u_content_text_4 .v-text-align { text-align: center !important; } #u_content_image_3 .v-container-padding-padding { padding: 10px 10px 0px !important; } #u_column_8 .v-col-padding { padding: 0px 0px 60px !important; } #u_content_button_1 .v-container-padding-padding { padding: 10px !important; } #u_content_button_1 .v-padding { padding: 10px 20px !important; } #u_column_9 .v-col-padding { padding: 50px 0px !important; } #u_content_text_8 .v-container-padding-padding { padding: 10px 20px !important; } #u_content_text_8 .v-line-height { line-height: 160% !important; } #u_content_text_1 .v-container-padding-padding { padding: 10px 20px !important; } }    </style>    <!--[if !mso]><!--><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap" rel="stylesheet" type="text/css"><link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300&display=swap" rel="stylesheet" type="text/css"><!--<![endif]--></head><body class="clean-body u_body" style="margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #e7e7e7;color: #000000">  <!--[if IE]><div class="ie-container"><![endif]-->  <!--[if mso]><div class="mso-container"><![endif]-->  <table id="u_body" style="border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #e7e7e7;width:100%" cellpadding="0" cellspacing="0">  <tbody>  <tr style="vertical-align: top">    <td style="word-break: break-word;border-collapse: collapse !important;vertical-align: top">    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color: #e7e7e7;"><![endif]-->    <div class="u-row-container" style="padding: 0px;background-color: #ffffff">  <div class="u-row" style="Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;">    <div style="border-collapse: collapse;display: table;width: 100%;height: 100%;background-image: url("images/image-5.png");background-repeat: no-repeat;background-position: left top;background-color: transparent;">      <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding: 0px;background-color: #ffffff;" align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:600px;"><tr style="background-image: url("images/image-5.png");background-repeat: no-repeat;background-position: left top;background-color: transparent;"><![endif]-->      <!--[if (mso)|(IE)]><td align="center" width="600" class="v-col-padding" style="background-color: #e644cf;width: 600px;padding: 100px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;" valign="top"><![endif]--><div class="u-col u-col-100" style="max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;">  <div style="background-color: #e644cf;height: 100%;width: 100% !important;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 100px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;"><!--<![endif]-->  <table id="u_content_heading_2" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">          <h1 class="v-text-align v-line-height v-font-size" style="margin: 0px; color: #ffffff; line-height: 120%; text-align: right; word-wrap: break-word; font-weight: normal; font-family: Ubuntu; font-size: 42px;">    日々をデザインする彩り<br />好きが届く私の暮らし  </h1>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]-->      <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->    </div>  </div></div><div class="u-row-container" style="padding: 0px;background-color: transparent">  <div class="u-row" style="Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;">    <div style="border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;">      <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding: 0px;background-color: transparent;" align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:600px;"><tr style="background-color: transparent;"><![endif]-->      <!--[if (mso)|(IE)]><td align="center" width="600" class="v-col-padding" style="background-color: #f4e2e2;width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;" valign="top"><![endif]--><div class="u-col u-col-100" style="max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;">  <div style="background-color: #f4e2e2;height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;"><!--<![endif]-->  <table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">          <h2 class="v-text-align v-line-height v-font-size" style="margin: 0px; line-height: 140%; text-align: center; word-wrap: break-word; font-weight: normal; font-family: arial,helvetica,sans-serif; font-size: 20px;">    melBee  </h2>      </td>    </tr>  </tbody></table><table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">          <div class="v-text-align v-line-height" style="line-height: 140%; text-align: center; word-wrap: break-word;">    <p style="font-size: 14px; line-height: 140%;">This is a new Text block. Change the text.</p>  </div>      </td>    </tr>  </tbody></table><table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">        <div class="v-text-align" align="center">  <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;font-family:"Montserrat",sans-serif;"><tr><td class="v-text-align" style="font-family:"Montserrat",sans-serif;" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="" style="height:37px; v-text-anchor:middle; width:110px;" arcsize="11%" stroke="f" fillcolor="#3AAEE0"><w:anchorlock/><center style="color:#FFFFFF;font-family:"Montserrat",sans-serif;"><![endif]-->    <a href="" target="_blank" style="box-sizing: border-box;display: inline-block;font-family:"Montserrat",sans-serif;text-decoration: none;-webkit-text-size-adjust: none;text-align: center;color: #FFFFFF; background-color: #3AAEE0; border-radius: 4px;-webkit-border-radius: 4px; -moz-border-radius: 4px; width:auto; max-width:100%; overflow-wrap: break-word; word-break: break-word; word-wrap:break-word; mso-border-alt: none;">      <span class="v-line-height v-padding" style="display:block;padding:10px 20px;line-height:120%;"><p style="font-size: 14px; line-height: 120%;"><span style="font-size: 14px; line-height: 16.8px;">もっと見る</span></p></span>    </a>  <!--[if mso]></center></v:roundrect></td></tr></table><![endif]--></div>      </td>    </tr>  </tbody></table><table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">          <h3 class="v-text-align v-line-height v-font-size" style="margin: 0px; line-height: 140%; text-align: center; word-wrap: break-word; font-weight: normal; font-family: arial,helvetica,sans-serif; font-size: 18px;">    melBee Awesome  </h3>      </td>    </tr>  </tbody></table><table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">          <div class="v-text-align v-line-height" style="line-height: 140%; text-align: center; word-wrap: break-word;">    <p style="font-size: 14px; line-height: 140%;">This is a new Text block. Change the text.</p>  </div>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]-->      <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->    </div>  </div></div><div class="u-row-container" style="padding: 0px;background-color: #ffffff">  <div class="u-row" style="Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;">    <div style="border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;">      <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding: 0px;background-color: #ffffff;" align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:600px;"><tr style="background-color: transparent;"><![endif]-->      <!--[if (mso)|(IE)]><td align="center" width="400" class="v-col-padding" style="width: 400px;padding: 100px 0px 60px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;" valign="top"><![endif]--><div id="u_column_2" class="u-col u-col-66p67" style="max-width: 320px;min-width: 400px;display: table-cell;vertical-align: top;">  <div style="height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 100px 0px 60px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;"><!--<![endif]-->  <table id="u_content_heading_1" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px 0px 10px 10px;font-family:"Montserrat",sans-serif;" align="left">          <h1 class="v-text-align v-line-height v-font-size" style="margin: 0px; color: #000000; line-height: 120%; text-align: left; word-wrap: break-word; font-weight: normal; font-family: Ubuntu; font-size: 30px;">    お花の定期便って？  </h1>      </td>    </tr>  </tbody></table><table id="u_content_text_7" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">          <div class="v-text-align v-line-height" style="color: #000000; line-height: 140%; text-align: left; word-wrap: break-word;">    <p style="font-size: 14px; line-height: 140%;">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Quis ipsum suspendisse ultrices gravida. Risus commodo viverra maecenas accumsan lacus vel facilisis. </p>  </div>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]--><!--[if (mso)|(IE)]><td align="center" width="200" class="v-col-padding" style="width: 200px;padding: 60px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;" valign="top"><![endif]--><div id="u_column_3" class="u-col u-col-33p33" style="max-width: 320px;min-width: 200px;display: table-cell;vertical-align: top;">  <div style="height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 60px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;"><!--<![endif]-->  <table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">        <table width="100%" cellpadding="0" cellspacing="0" border="0">  <tr>    <td class="v-text-align" style="padding-right: 0px;padding-left: 0px;" align="center">            <img align="center" border="0" src="images/image-6.png" alt="image" title="image" style="outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: inline-block !important;border: none;height: auto;float: none;width: 100%;max-width: 180px;" width="180"/>          </td>  </tr></table>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]-->      <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->    </div>  </div></div><div class="u-row-container" style="padding: 0px;background-color: #ecf0f1">  <div class="u-row" style="Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;">    <div style="border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;">      <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding: 0px;background-color: #ecf0f1;" align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:600px;"><tr style="background-color: transparent;"><![endif]-->      <!--[if (mso)|(IE)]><td align="center" width="192" class="v-col-padding" style="width: 192px;padding: 50px 0px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;" valign="top"><![endif]--><div class="u-col u-col-32" style="max-width: 320px;min-width: 192px;display: table-cell;vertical-align: top;">  <div style="height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 50px 0px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;"><!--<![endif]-->  <table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:0px;font-family:"Montserrat",sans-serif;" align="left">        <table width="100%" cellpadding="0" cellspacing="0" border="0">  <tr>    <td class="v-text-align" style="padding-right: 0px;padding-left: 0px;" align="center">            <img align="center" border="0" src="images/image-7.png" alt="image" title="image" style="outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: inline-block !important;border: none;height: auto;float: none;width: 100%;max-width: 192px;" width="192"/>          </td>  </tr></table>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]--><!--[if (mso)|(IE)]><td align="center" width="408" class="v-col-padding" style="width: 408px;padding: 50px 0px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;" valign="top"><![endif]--><div id="u_column_5" class="u-col u-col-68" style="max-width: 320px;min-width: 408px;display: table-cell;vertical-align: top;">  <div style="height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 50px 0px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;"><!--<![endif]-->  <table id="u_content_text_3" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px 10px 0px;font-family:"Montserrat",sans-serif;" align="left">          <div class="v-text-align v-line-height" style="line-height: 140%; text-align: left; word-wrap: break-word;">    <p style="font-size: 14px; line-height: 140%;"><span style="font-family: Ubuntu; font-size: 16px; line-height: 22.4px;"><strong>9:00AM - 11:00AM</strong></span></p>  </div>      </td>    </tr>  </tbody></table><table id="u_content_text_6" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:0px 10px 10px;font-family:"Montserrat",sans-serif;" align="left">          <div class="v-text-align v-line-height" style="line-height: 140%; text-align: left; word-wrap: break-word;">    <p style="font-size: 14px; line-height: 140%;"><strong><span style="font-family: Ubuntu; font-size: 22px; line-height: 30.8px;">Delivery</span></strong></p>  </div>      </td>    </tr>  </tbody></table><table id="u_content_text_5" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">          <div class="v-text-align v-line-height" style="line-height: 140%; text-align: left; word-wrap: break-word;">    <p style="font-size: 14px; line-height: 140%;">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>  </div>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]-->      <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->    </div>  </div></div><div class="u-row-container" style="padding: 0px;background-color: #ecf0f1">  <div class="u-row" style="Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;">    <div style="border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;">      <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding: 0px;background-color: #ecf0f1;" align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:600px;"><tr style="background-color: transparent;"><![endif]-->      <!--[if (mso)|(IE)]><td align="center" width="319" class="v-col-padding" style="width: 319px;padding: 35px 0px 50px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;" valign="top"><![endif]--><div id="u_column_6" class="u-col u-col-53p17" style="max-width: 320px;min-width: 319.02px;display: table-cell;vertical-align: top;">  <div style="height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 35px 0px 50px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;"><!--<![endif]-->  <table id="u_content_text_4" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:0px 10px 10px;font-family:"Montserrat",sans-serif;" align="left">          <div class="v-text-align v-line-height" style="line-height: 140%; text-align: left; word-wrap: break-word;">    <p style="font-size: 14px; line-height: 140%;"><strong><span style="font-family: Ubuntu; font-size: 16px; line-height: 22.4px;">Location : Street #4667 San Francisco</span></strong></p>  </div>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]--><!--[if (mso)|(IE)]><td align="center" width="81" class="v-col-padding" style="width: 81px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;" valign="top"><![endif]--><div class="u-col u-col-13p5" style="max-width: 320px;min-width: 81px;display: table-cell;vertical-align: top;">  <div style="height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;"><!--<![endif]-->  <table id="u_content_image_3" class="hide-mobile" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">        <table width="100%" cellpadding="0" cellspacing="0" border="0">  <tr>    <td class="v-text-align" style="padding-right: 0px;padding-left: 0px;" align="center">            <img align="center" border="0" src="images/image-8.png" alt="image" title="image" style="outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: inline-block !important;border: none;height: auto;float: none;width: 100%;max-width: 27px;" width="27"/>          </td>  </tr></table>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]--><!--[if (mso)|(IE)]><td align="center" width="199" class="v-col-padding" style="width: 199px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;" valign="top"><![endif]--><div id="u_column_8" class="u-col u-col-33p33" style="max-width: 320px;min-width: 199.98px;display: table-cell;vertical-align: top;">  <div style="height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;"><!--<![endif]-->  <table id="u_content_button_1" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:30px 10px 10px;font-family:"Montserrat",sans-serif;" align="left">        <div class="v-text-align" align="center">  <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;font-family:"Montserrat",sans-serif;"><tr><td class="v-text-align" style="font-family:"Montserrat",sans-serif;" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="https://www.unlayer.com" style="height:37px; v-text-anchor:middle; width:151px;" arcsize="59.5%" stroke="f" fillcolor="#e67e23"><w:anchorlock/><center style="color:#FFFFFF;font-family:"Montserrat",sans-serif;"><![endif]-->    <a href="https://www.unlayer.com" target="_blank" style="box-sizing: border-box;display: inline-block;font-family:"Montserrat",sans-serif;text-decoration: none;-webkit-text-size-adjust: none;text-align: center;color: #FFFFFF; background-color: #e67e23; border-radius: 22px;-webkit-border-radius: 22px; -moz-border-radius: 22px; width:84%; max-width:100%; overflow-wrap: break-word; word-break: break-word; word-wrap:break-word; mso-border-alt: none;">      <span class="v-line-height v-padding" style="display:block;padding:10px 20px;line-height:120%;"><strong>Register Now</strong></span>    </a>  <!--[if mso]></center></v:roundrect></td></tr></table><![endif]--></div>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]-->      <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->    </div>  </div></div><div class="u-row-container" style="padding: 0px;background-color: #ffffff">  <div class="u-row" style="Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;">    <div style="border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;">      <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding: 0px;background-color: #ffffff;" align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:600px;"><tr style="background-color: transparent;"><![endif]-->      <!--[if (mso)|(IE)]><td align="center" width="600" class="v-col-padding" style="width: 600px;padding: 50px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;" valign="top"><![endif]--><div id="u_column_9" class="u-col u-col-100" style="max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;">  <div style="height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;">  <!--[if (!mso)&(!IE)]><!--><div class="v-col-padding" style="height: 100%; padding: 50px 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;"><!--<![endif]-->  <table id="u_content_text_8" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px 50px;font-family:"Montserrat",sans-serif;" align="left">          <div class="v-text-align v-line-height" style="color: #000000; line-height: 160%; text-align: center; word-wrap: break-word;">    <p style="font-size: 14px; line-height: 160%;">if you have any questions, please email us at help@unlayer.com or visit our FAQS, you can also chat with a reel live human during our operating hours. </p>  </div>      </td>    </tr>  </tbody></table><table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:40px 10px;font-family:"Montserrat",sans-serif;" align="left">          <table height="0px" align="center" border="0" cellpadding="0" cellspacing="0" width="59%" style="border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;border-top: 1px solid #BBBBBB;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%">    <tbody>      <tr style="vertical-align: top">        <td style="word-break: break-word;border-collapse: collapse !important;vertical-align: top;font-size: 0px;line-height: 0px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%">          <span>&#160;</span>        </td>      </tr>    </tbody>  </table>      </td>    </tr>  </tbody></table><table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">        <div align="center">  <div style="display: table; max-width:171px;">  <!--[if (mso)|(IE)]><table width="171" cellpadding="0" cellspacing="0" border="0"><tr><td style="border-collapse:collapse;" align="center"><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse; mso-table-lspace: 0pt;mso-table-rspace: 0pt; width:171px;"><tr><![endif]-->          <!--[if (mso)|(IE)]><td width="32" style="width:32px; padding-right: 11px;" valign="top"><![endif]-->    <table align="left" border="0" cellspacing="0" cellpadding="0" width="32" height="32" style="width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 11px">      <tbody><tr style="vertical-align: top"><td align="left" valign="middle" style="word-break: break-word;border-collapse: collapse !important;vertical-align: top">        <a href="https://facebook.com/" title="Facebook" target="_blank">          <img src="images/image-4.png" alt="Facebook" title="Facebook" width="32" style="outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important">        </a>      </td></tr>    </tbody></table>    <!--[if (mso)|(IE)]></td><![endif]-->        <!--[if (mso)|(IE)]><td width="32" style="width:32px; padding-right: 11px;" valign="top"><![endif]-->    <table align="left" border="0" cellspacing="0" cellpadding="0" width="32" height="32" style="width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 11px">      <tbody><tr style="vertical-align: top"><td align="left" valign="middle" style="word-break: break-word;border-collapse: collapse !important;vertical-align: top">        <a href="https://linkedin.com/" title="LinkedIn" target="_blank">          <img src="images/image-1.png" alt="LinkedIn" title="LinkedIn" width="32" style="outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important">        </a>      </td></tr>    </tbody></table>    <!--[if (mso)|(IE)]></td><![endif]-->        <!--[if (mso)|(IE)]><td width="32" style="width:32px; padding-right: 11px;" valign="top"><![endif]-->    <table align="left" border="0" cellspacing="0" cellpadding="0" width="32" height="32" style="width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 11px">      <tbody><tr style="vertical-align: top"><td align="left" valign="middle" style="word-break: break-word;border-collapse: collapse !important;vertical-align: top">        <a href="https://instagram.com/" title="Instagram" target="_blank">          <img src="images/image-2.png" alt="Instagram" title="Instagram" width="32" style="outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important">        </a>      </td></tr>    </tbody></table>    <!--[if (mso)|(IE)]></td><![endif]-->        <!--[if (mso)|(IE)]><td width="32" style="width:32px; padding-right: 0px;" valign="top"><![endif]-->    <table align="left" border="0" cellspacing="0" cellpadding="0" width="32" height="32" style="width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 0px">      <tbody><tr style="vertical-align: top"><td align="left" valign="middle" style="word-break: break-word;border-collapse: collapse !important;vertical-align: top">        <a href="https://twitter.com/" title="Twitter" target="_blank">          <img src="images/image-3.png" alt="Twitter" title="Twitter" width="32" style="outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important">        </a>      </td></tr>    </tbody></table>    <!--[if (mso)|(IE)]></td><![endif]-->            <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->  </div></div>      </td>    </tr>  </tbody></table><table style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:"Montserrat",sans-serif;" align="left">        <div class="menu" style="text-align:center"><!--[if (mso)|(IE)]><table role="presentation" border="0" cellpadding="0" cellspacing="0" align="center"><tr><![endif]-->  <!--[if (mso)|(IE)]><td style="padding:5px 15px"><![endif]-->      <a href="https://www.unlayer.com" target="_self" style="padding:5px 15px;display:inline-block;color:#000000;font-family:"Montserrat",sans-serif;font-size:14px;text-decoration:none"  class="v-padding v-font-size">      Head Office    </a>    <!--[if (mso)|(IE)]></td><![endif]-->    <!--[if (mso)|(IE)]><td style="padding:5px 15px"><![endif]-->      <a href="https://www.unlayer.com" target="_self" style="padding:5px 15px;display:inline-block;color:#000000;font-family:"Montserrat",sans-serif;font-size:14px;text-decoration:none"  class="v-padding v-font-size">      How it works    </a>    <!--[if (mso)|(IE)]></td><![endif]-->    <!--[if (mso)|(IE)]><td style="padding:5px 15px"><![endif]-->      <a href="https://www.unlayer.com" target="_self" style="padding:5px 15px;display:inline-block;color:#000000;font-family:"Montserrat",sans-serif;font-size:14px;text-decoration:none"  class="v-padding v-font-size">      FAQs    </a>    <!--[if (mso)|(IE)]></td><![endif]-->    <!--[if (mso)|(IE)]><td style="padding:5px 15px"><![endif]-->      <a href="https://www.unlayer.com" target="_self" style="padding:5px 15px;display:inline-block;color:#000000;font-family:"Montserrat",sans-serif;font-size:14px;text-decoration:none"  class="v-padding v-font-size">      T&Cs    </a>    <!--[if (mso)|(IE)]></td><![endif]-->  <!--[if (mso)|(IE)]></tr></table><![endif]--></div>      </td>    </tr>  </tbody></table><table id="u_content_text_1" style="font-family:"Montserrat",sans-serif;" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0">  <tbody>    <tr>      <td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px 70px;font-family:"Montserrat",sans-serif;" align="left">          <div class="v-text-align v-line-height" style="color: #000000; line-height: 140%; text-align: center; word-wrap: break-word;">    <p style="font-size: 14px; line-height: 140%;"><strong>you have received this email as a registered user of unlayer.com can unsubscribe from these emails here.</strong></p><p style="font-size: 14px; line-height: 140%;"> </p><p style="font-size: 14px; line-height: 140%;">2261 Market Street #4667 San Francisco, CA 94114 All rights reserved</p>  </div>      </td>    </tr>  </tbody></table>  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->  </div></div><!--[if (mso)|(IE)]></td><![endif]-->      <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->    </div>  </div></div>    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->    </td>  </tr>  </tbody>  </table>  <!--[if mso]></div><![endif]-->  <!--[if IE]></div><![endif]--></body></html>'

if __name__ == '__main__':
    service = getService()
    user_id = "me"
    sender = "test@gmail.com"
    to = "test@gmail.com"
    subject = "TEST"
    body = "TEST"
    msg = create_message(sender, to, subject, body)
    send_message(service, user_id, msg)


